# PMAlign

### 学习目标
- 识别何时使用PMAlign作为解决视觉应用的一工具
- 创建并配置一个PMAlign工具来查找不同运行条件下的图案
- 训练图案并确定自动提取的特征对于该应用是否有效
- 评价参数设置，确定对于不同的运行条件需要哪些参数
- 优化执行时间和精确度
### PatMax介绍
- PatMax® 是一种图案位置搜索技术，不依赖像素格
- 特征 是表示图像中不同区域之间界限的轮廓线
- 基于特征的表现可以比像素格栅表现更快捷和更准确
### PatMax功能
- 使用一个工具测量
    - 图案的位置
    - 相对于原来训练图案的尺寸
    - 相对于原来训练图案的角度
- 空前的精确度
    - 多达1/40像素的平移
    - 多达1/50 度的旋转
    - 多达0.05%比例
- 速度得到提高
    - 基本图案查找速度更快
    - 角度和尺寸的确定更快
- 对齐结果得到改善
    - 处理的图像对比度范围较广
    - 散焦、部分遮挡和预期之外的特征可以忍受
- 更易于使用
    - 在一个步骤中直接测量角度和尺寸大小
    - 图案可以在没有保真度损失的情况下在工具之间传送
### PatMax应用
- 基于基准点对齐 印刷电路板应用（**对齐**）
- 定位罐头上的拉环：在平移、旋转、和灯光方面的差异（**探测是否存在**）
- 尽管型号有差异、灯光有变化、元件角度旋转、外形极其相似，也可以对引擎盖进行识别（**整理和归类**）
### ParMax算法
- **PatQuick™**
    - 速度最快
    - 对于三维或者低质量元件最佳
    - 承受更多图像差异
    - 例子：捡放
- **PatMax®**
    - 精确度最高
    - 在二维元件上表现最佳
    - 最适合于细微细节
    - 例子：薄片对齐
- **PatFlex**
    - 为高度灵活的图案设计
    - 在弯曲不平的表面上表现较佳
    - 极其灵活，但不够精准
    - 例子：标签定位
### 链接工具
- 需要图像用于图案训练：运行间检查
- 链接像源的输出图像（**OutputImage**）到**PMAlign**的输入图像（**InputImage**）拖放
### 训练图案
- PMAlign工具有三个相关的图像
- 要训练我们的图案，我们需要一个**Current.TranImage**
### **Current.InputImage**
- PMAlign工具还有一个可以是运行期间也可以是“抓取”作为训练图像的**Current.InputImage**
### 抓取训练图像
- 在控件中按下抓取训练图像按钮
### PatMax图案
- 在您训练一个图案时，PatMax 确定该图案中包含的所有特征
- 特征是表示图像中不同区域之间界限的轮廓线
- 特征即一系列沿着轮廓线排列的分界点
- 分界点是图像中坐标位置（x、y）和其垂直于轮廓线的方向来定义的
### 图案训练
- PatMax® 图案训练的总指南：
- 选择一个有一致特征的代表性图案
    - 减少不必要的特征和图像噪音
    - 只训练重要的特征
    - 考虑遮罩，来创建特定的图案
- 更大的图案会提供更高的精确度
    - 实际上，分界点越多，精确度越高
### 图案区域和原点
- 在使用图形时
    - 拖动并调整图案周围训练框的大小
    - 在适当的位置上定位原点
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316200105.png)  
    - 下一步，定义包含要训练的图案的像素区域和图案原点
        - 使用图形或者在训练区域和原点标签中输入值  
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316200308.png)  
    - 模型原点
        - 在PatMax®定位搜索场景中模型的实例时，模型原点可以辨别要向您报告的点
        - 要维持最高的精确度，原点必须放置图案区域的重心
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316200529.png)  
    - 训练图案
        - 按下训练按钮训练团，PatMax会找到区域中的特征
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316200657.png)  
    - 图案特征
        - 要看看PatMax使用该图案已经探测到什么作为要查找特征，需要勾选训练特征图形
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316200849.png)  
        - 黄线表示粗糙特征
        - 绿线表示精细特征  
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316201104.png)
        - 放大以便更近距离的查看所探测到的特征  
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316201316.png)
    - **InfoStrings**
        - 寻找任何**InfoStrings**
            - 这些将表示图案训练是否成功
            - 它们还警告受训图案可能存在的各种问题
    - 图案极性
        - 默认状态下，PatMax®只查找与受训团具有相同极性的图案
        - 可以配置PatMax®忽略图案的极性并且只使用特征形状信息
        - 勾选复选框忽略极性（允许极性变化）    
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316201907.png)
        - 极性是对PatMax®的一个提示，可以使得图案更明确些，应该使用极性，除非对象受极性变化的影响。  
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316202126.png)
        