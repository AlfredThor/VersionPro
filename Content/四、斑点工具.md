# 斑点工具

### 学习目标
- 识别斑点工具是解决视觉方案的一部分
- 创建并且配置一个斑点工具
    - 在指定的灰度范围内查找斑点
    - 根据给定的标准筛选斑点
---
### 概述
- 斑点分析探测并且分析图像中的二维形状
- 斑点通过辨别处于用户定义的灰度范围内的不同的像素组来查找对象
- 斑点报告多重共属性：
    - 面积
    - 质心
    - 周长
    - 主轴
    
### 何时使用斑点
- 斑点分析非常适合一下场合使用：
    - 对象在尺寸、形状或方向上差异很大（训练模型很难或者不可能）
    - 对象有背景中找不到的截然不同的回读
    - 对象没有重叠或者接触
- 应用案例：
    - 检查环氧树脂点分配的数量、尺寸和形状
    - 检查表示坏薄片模型的莫水电的正确位置和大小
    - 检查药片的破碎和大小
    - 根据对象的尺寸、形状或位置整理或分类对象  
[图片](https://github.com/Hellathor/VersionPro/blob/main/img/20220316143450.jpg)
### 分割
- 斑点在其运行时所做的第一件事就是图像分割，确定哪些像素是斑点像素以及哪些是背景像素
- 有数种模式可以指定哪些可以将斑点与背景像素分开
- 多数模式会要求：
    - 极性
        - 在光亮背景上的黑色、斑点
        - 在黑色背景上的光亮斑点
    - 阀值
        - 将斑点像素从背景像素中分开来的值
- 固定阀值
    - 在固定阀值中，斑点像素和背景像素分别根据灰度值来确定
    - 确定一个灰度值阀值
- 相对阀值
    - 相对阀值解释为左尾和右尾之间全体像素的百分点
    - 尾度代表柱状图两端的噪音像素  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316155149.png)
- 使用相对阀值
    - 相对阀值调整因为线性灯光变化  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316155327.png)
- 固定和相对阀值
    - 固定的灰度阀值不提供线性灯光变化  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316155457.png)
    - 固定的阀值要比相对的速度**快**，因为与百分比对应灰度不必计算
    - 固定阀值可以检测场景中是否有某特征，而相对阀值始终在场景中找到一个半点  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316155728.png)
- 硬性阀值
    - 到目前为止所有例子都是用了硬性阀值
        - 该值（灰度或百分比）将斑点像素从背景像素中分开  
        [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316155948.png)
    - 阀值动态地选择，对于灰度双峰分布的图像有益  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316160223.png)
    - 规定单个百分数和尾度  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316160334.png)
    - 规定单个灰度值  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316160412.png)
- 空间量化错误
    - 当对象在不同图像降落在不同的像素格子上时，硬性阀值同时重现
    - 可能导致斑点尺寸、周长、位置的错误结果
    - 随着对象周长加长，错误变得更加明显
- 像素加权
    - 空间量化错误可以通过应用像素加权来消除
    - 当斑点对应于像素格子移动时，总权数保持不变
- 软性阀值
    - 使用软性阀值创建一个像素加权计划
    - 软性阀值使用一系列阀值  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316161038.png)
- 软性阀值例子
    - 低阀值 = 50
    - 高阀值 = 65
    - 软度 = 3  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316161209.png)
    - 阀值使用灰度表示  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316161353.png)
    - 阀值和尾度使用百分数表示  
    [img](https://github.com/Hellathor/VersionPro/blob/main/img/20220316161448.png)